@{ 
    var posting = true;
}

<div class="row">
    <div class="col-md-12 grid-margin">
        <div class="d-flex justify-content-between flex-wrap">
            <div class="d-flex align-items-end flex-wrap">
                <div class="me-md-3 me-xl-5">
                    <h2>Announcement</h2>
                    <br />
                    <div class="mb-md-0">
                        <a asp-controller="Announcement" asp-action="Create" class="btn btn-success mt-2 mt-xl-0">
                            <i class="mdi mdi-plus" style="font-size:15px"></i> &nbsp Create New Annoucement
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-md-12 stretch-card">
        <div class="card">
            <div class="card-body">
                <p class="card-title">Announcement List</p>
                <div class="table-responsive">
                    <table id="recent-purchases-listing" class="table table-hover">
                        <thead>
                            <tr>
                                <th>Title</th>
                                <th>Date Created</th>
                                <th>Posting</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            @* @foreach (var obj in Model)
                            {
                            <tr>
                            <td>@obj.Name</td>
                            <td>dummydata</td>
                            <td>dummydata</td>
                            <td>dummydata</td>
                            </tr>
                            } *@
                            <tr>
                                <td>dummydata</td>
                                <td>dummydata</td>
                                <td>
                                    <!-- Rounded switch -->
                                    <label class="switch">
                                        <input type="checkbox">
                                        <span class="slider round"></span>
                                    </label>
                                </td>
                                <td>
                                    <a onclick="" class="btn btn-datatable btn-icon mt-1">
                                        <i class="mdi mdi-border-color" style="color:blue; font-size:25px;"></i>
                                    </a>
                                    <a onclick="Delete('')" class="btn btn-datatable btn-icon">
                                        <i class="mdi mdi-delete-forever" style="color:red; font-size:25px;"></i>
                                    </a>
                                </td>
                            </tr>
                            <tr>
                                <td>dummydata</td>
                                <td>dummydata</td>
                                <td>
                                    <!-- Rounded switch -->
                                 
                                    <label class="switch">
                                        <input type="checkbox" @if (posting) { <text>checked</text> } onchange="toggleSwitch(this)">
                                        <span class="slider round"></span>
                                    </label>
                                </td>
                                <td>
                                    <a onclick="" class="btn btn-datatable btn-icon mt-1">
                                        <i class="mdi mdi-border-color" style="color:blue; font-size:25px;"></i>
                                    </a>
                                    <a onclick="Delete('')" class="btn btn-datatable btn-icon">
                                        <i class="mdi mdi-delete-forever" style="color:red; font-size:25px;"></i>
                                    </a>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>


@* function Delete(url) {
    Swal.fire({
        title: 'Are you sure?',
        text: "You won't be able to revert this!",
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#3085d6',
        cancelButtonColor: '#d33',
        confirmButtonText: 'Yes, delete it!'
    }).then((result) => {
        if (result.isConfirmed) {
            $.ajax({
                url: url,
                type: 'DELETE',
                success: function (data) {
                    dataTable.ajax.reload();
                    toastr.success(data.message);
                }
            })
        }
    })
} *@

<script>
    @*function postDateTime() {
        Swal.fire({
            title: "select posting date",
            input: "date",
            didOpen: () => {
                const today = (new Date()).toISOString();
                Swal.getInput().min = today.split("T")[0];
            }
        });
        if (date) {
            Swal.fire("Departure date", date);
        }
    }*@

    function postDateTime(checkbox) {
        Swal.fire({
            title: "Select posting date and time",
            input: "datetime-local",
            inputAttributes: {
                min: new Date().toISOString().slice(0, 16) // Set the minimum date to the current date and time
            },
            showCancelButton: true,
            confirmButtonText: 'Submit',
            cancelButtonText: 'Cancel',
            inputValidator: (value) => {
                if (!value) {
                    return 'You need to choose a date and time!';
                }
            }
        }).then((result) => {
            if (result.isConfirmed) {
                Swal.fire("Posting date and time", result.value);
            } else {
                // User canceled, revert checkbox state
                checkbox.checked = false; // Keep the switch off
            }
        });
    }

    function toggleSwitch(checkbox) {
        if (checkbox.checked) {
            // Checkbox is checked (turned on), trigger postDateTime
            postDateTime(checkbox);
        } else {
            // Checkbox is unchecked (turned off), show confirmation dialog
            Swal.fire({
                title: 'Are you sure?',
                text: 'Do you want to turn off posting?',
                icon: 'warning',
                showCancelButton: true,
                confirmButtonText: 'Yes, turn off',
                cancelButtonText: 'Cancel'
            }).then((result) => {
                if (result.isConfirmed) {
                    // User confirmed, perform action (e.g., turn off posting)
                    // Additional logic here if needed
                } else {
                    // User canceled, revert checkbox state
                    checkbox.checked = true; // Keep the switch on
                }
            });
        }
    }
</script>
